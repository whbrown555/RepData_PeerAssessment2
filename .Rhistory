gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
# gg2<- gg2 + xlab("NOAA Standard Event Type")
gg2<- gg2 + ylab("Injuries")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Health Impact of Severe Weather in the United States")
require(ggplot2)
# Health Impact Analysis
gg1<- ggplot(dead[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg1<- gg1 + geom_bar(stat = "identity")
gg1<- gg1 + xlab("")
gg1<- gg1 + ylab("Fatalities")
gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
gg2<- gg2 + xlab("")
gg2<- gg2 + ylab("Injuries")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Health Impact of Severe Weather in the United States")
require(ggplot2)
# Health Impact Analysis
gg1<- ggplot(dead[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg1<- gg1 + geom_bar(stat = "identity")
gg1<- gg1 + xlab("")
gg1<- gg1 + ylab("Fatalities")
gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
gg2<- gg2 + xlab("")
gg2<- gg2 + ylab("Injuries")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Health Impact of Severe Weather in the United States
by Event Type")
# aggregate the data by the "tidy" event type
dead <- aggregate(FATALITIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
dead$NOAA_EVTYPE <- factor(dead$NOAA_EVTYPE,
levels = dead$NOAA_EVTYPE[order(-dead$IMPACT_VAL)])
dead$IMPACT_TYPE <- "FATALITIES"
colnames(dead)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
wounded <- aggregate(INJURIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
wounded$NOAA_EVTYPE <- factor(wounded$NOAA_EVTYPE,
levels = wounded$NOAA_EVTYPE[order(-wounded$IMPACT_VAL)])
wounded$IMPACT_TYPE <- "INJURIES"
colnames(wounded)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
property <- aggregate(PROPDMGVAL ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
property$NOAA_EVTYPE <- factor(property$NOAA_EVTYPE,
levels = property$NOAA_EVTYPE[order(-property$IMPACT_VAL)])
property$IMPACT_TYPE <- "PROPDMGVAL"
colnames(property)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
crops <- aggregate(CROPDMGVAL ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
crops$IMPACT_TYPE <- "CROPDMGVAL"
colnames(crops)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
crops$NOAA_EVTYPE <- factor(crops$NOAA_EVTYPE,
levels = crops$NOAA_EVTYPE[order(-crops$IMPACT_VAL)])
# impact <- dead[,c(3,1,2)]
# impact <- rbind(impact, wounded[,c(3,1,2)])
# impact <- rbind(impact, property[,c(3,1,2)])
# impact <- rbind(impact, crops[,c(3,1,2)])
# impact$NOAA_EVTYPE <- factor(crops$NOAA_EVTYPE,
#                            levels = crops$NOAA_EVTYPE[order(-crops$IMPACT_VAL)])
# colnames(impact)<- c("IMPACT_TYPE","NOAA_EVTYPE","IMPACT_VAL")
#sort the impact dataframe
require(ggplot2)
# Health Impact Analysis
gg1<- ggplot(dead[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg1<- gg1 + geom_bar(stat = "identity")
gg1<- gg1 + xlab("")
gg1<- gg1 + ylab("Fatalities")
gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
gg2<- gg2 + xlab("")
gg2<- gg2 + ylab("Injuries")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Health Impact of Severe Weather in the United States
by Event Type")
# aggregate the data by the "tidy" event type
dead <- aggregate(FATALITIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
dead$NOAA_EVTYPE <- factor(dead$NOAA_EVTYPE,
levels = dead$NOAA_EVTYPE[order(-dead$IMPACT_VAL)])
dead$IMPACT_TYPE <- "FATALITIES"
colnames(dead)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
dead<-order(-dead$IMPACT_VAL)
wounded <- aggregate(INJURIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
wounded$NOAA_EVTYPE <- factor(wounded$NOAA_EVTYPE,
levels = wounded$NOAA_EVTYPE[order(-wounded$IMPACT_VAL)])
wounded$IMPACT_TYPE <- "INJURIES"
colnames(wounded)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
wounded<-order(-wounded$IMPACT_VAL)
property <- aggregate(PROPDMGVAL ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
property$NOAA_EVTYPE <- factor(property$NOAA_EVTYPE,
levels = property$NOAA_EVTYPE[order(-property$IMPACT_VAL)])
property$IMPACT_TYPE <- "PROPDMGVAL"
colnames(property)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
property<-order(-property$IMPACT_VAL)
crops <- aggregate(CROPDMGVAL ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
crops$IMPACT_TYPE <- "CROPDMGVAL"
colnames(crops)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
crops$NOAA_EVTYPE <- factor(crops$NOAA_EVTYPE,
levels = crops$NOAA_EVTYPE[order(-crops$IMPACT_VAL)])
crops<-order(-crops$IMPACT_VAL)
# impact <- dead[,c(3,1,2)]
# impact <- rbind(impact, wounded[,c(3,1,2)])
# impact <- rbind(impact, property[,c(3,1,2)])
# impact <- rbind(impact, crops[,c(3,1,2)])
# impact$NOAA_EVTYPE <- factor(crops$NOAA_EVTYPE,
#                            levels = crops$NOAA_EVTYPE[order(-crops$IMPACT_VAL)])
# colnames(impact)<- c("IMPACT_TYPE","NOAA_EVTYPE","IMPACT_VAL")
#sort the impact dataframe
dead<-order(dead,-dead$IMPACT_VAL)
?order
dead<-order(dead,-xtfrm(dead$IMPACT_VAL))
dead <- aggregate(FATALITIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
dead$NOAA_EVTYPE <- factor(dead$NOAA_EVTYPE,
levels = dead$NOAA_EVTYPE[order(-dead$IMPACT_VAL)])
dead$IMPACT_TYPE <- "FATALITIES"
colnames(dead)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
dead<-dead[order(-xtfrm(dead$IMPACT_VAL),dead$NOAA_EVTYPE)]
dead <- aggregate(FATALITIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
dead$IMPACT_TYPE <- "FATALITIES"
colnames(dead)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
dead$NOAA_EVTYPE <- factor(dead$NOAA_EVTYPE,
levels = dead$NOAA_EVTYPE[order(-dead$IMPACT_VAL)])
dead<-dead[order(-xtfrm(dead$IMPACT_VAL),dead$NOAA_EVTYPE)]
View(dead)
dead <- aggregate(FATALITIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
dead$IMPACT_TYPE <- "FATALITIES"
colnames(dead)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
dead$NOAA_EVTYPE <- factor(dead$NOAA_EVTYPE,
levels = dead$NOAA_EVTYPE[order(-dead$IMPACT_VAL)])
dead<-dead[order(-xtfrm(dead$IMPACT_VAL),dead$NOAA_EVTYPE)]
dead<-dead[order(-xtfrm(dead$IMPACT_VAL),dead$NOAA_EVTYPE),]
rownames(dead)<-seq(1:nrow(dead))
# aggregate the data by the "tidy" event type
dead <- aggregate(FATALITIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
dead$IMPACT_TYPE <- "FATALITIES"
colnames(dead)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
dead$NOAA_EVTYPE <- factor(dead$NOAA_EVTYPE,
levels = dead$NOAA_EVTYPE[order(-dead$IMPACT_VAL)])
dead<-dead[order(-xtfrm(dead$IMPACT_VAL),dead$NOAA_EVTYPE),]
rownames(dead)<-seq(1:nrow(dead))
wounded <- aggregate(INJURIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
wounded$NOAA_EVTYPE <- factor(wounded$NOAA_EVTYPE,
levels = wounded$NOAA_EVTYPE[order(-wounded$IMPACT_VAL)])
wounded$IMPACT_TYPE <- "INJURIES"
colnames(wounded)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
wounded<-wounded[order(-xtfrm(wounded$IMPACT_VAL),wounded$NOAA_EVTYPE),]
rownames(wounded)<-seq(1:nrow(wounded))
property <- aggregate(PROPDMGVAL ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
property$NOAA_EVTYPE <- factor(property$NOAA_EVTYPE,
levels = property$NOAA_EVTYPE[order(-property$IMPACT_VAL)])
property$IMPACT_TYPE <- "PROPDMGVAL"
colnames(property)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
property<-property[order(-xtfrm(property$IMPACT_VAL),property$NOAA_EVTYPE),]
rownames(property)<-seq(1:nrow(property))
crops <- aggregate(CROPDMGVAL ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
crops$IMPACT_TYPE <- "CROPDMGVAL"
colnames(crops)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
crops$NOAA_EVTYPE <- factor(crops$NOAA_EVTYPE,
levels = crops$NOAA_EVTYPE[order(-crops$IMPACT_VAL)])
crops<-crops[order(-xtfrm(crops$IMPACT_VAL),crops$NOAA_EVTYPE),]
rownames(crops)<-seq(1:nrow(crops))
# impact <- dead[,c(3,1,2)]
# impact <- rbind(impact, wounded[,c(3,1,2)])
# impact <- rbind(impact, property[,c(3,1,2)])
# impact <- rbind(impact, crops[,c(3,1,2)])
# impact$NOAA_EVTYPE <- factor(crops$NOAA_EVTYPE,
#                            levels = crops$NOAA_EVTYPE[order(-crops$IMPACT_VAL)])
# colnames(impact)<- c("IMPACT_TYPE","NOAA_EVTYPE","IMPACT_VAL")
#sort the impact dataframe
require(ggplot2)
# Health Impact Analysis
gg1<- ggplot(dead[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg1<- gg1 + geom_bar(stat = "identity")
gg1<- gg1 + xlab("")
gg1<- gg1 + ylab("Fatalities")
gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
gg2<- gg2 + xlab("")
gg2<- gg2 + ylab("Injuries")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Health Impact of Severe Weather in the United States
by Event Type")
source('~/DataScience/ExploratoryDataAnalysis/exdata-data-NEI_data/clEnv.R', echo=TRUE)
# Chunk 1
Sys.setlocale("LC_ALL", "English")
require(markdown)
require(knitr)
# Chunk 2: setup
knitr::opts_chunk$set(cache=TRUE)
# Chunk 3
setwd("~/GitHub/RepData_PeerAssessment2")
# download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2","repdata%2Fdata%2FStormData.csv.bz2")
stormData<-read.csv("repdata%2Fdata%2FStormData.csv.bz2")
# Chunk 4
sdata <- data.frame(stormData[,c(8,23, 24, 25,26, 27,28,36)], stringsAsFactors = FALSE)
# Chunk 5
levels(stormData$PROPDMGEXP)
summary(stormData$PROPDMGEXP)
stormData$PROPDMG[(stormData$PROPDMGEXP %in% c("?", "-", "+"))]
levels(stormData$CROPDMGEXP)
summary(stormData$CROPDMGEXP)
stormData$CROPDMG[(stormData$CROPDMGEXP %in% c("?", "-", "+"))]
# Chunk 6
# Ensure that the *EXP variables are of class "character" (vs. "factor")
sdata$PROPDMGEXP<-as.character(sdata$PROPDMGEXP)
sdata$CROPDMGEXP<-as.character(sdata$CROPDMGEXP)
# Transform the *EXP values to enable arithmetic operations
sdata$PROPDMGEXP[(sdata$PROPDMGEXP %in% c("B", "b"))] <-9
sdata$PROPDMGEXP[(sdata$PROPDMGEXP %in% c("M", "m"))] <-6
sdata$PROPDMGEXP[(sdata$PROPDMGEXP %in% c("K", "k"))] <-3
sdata$PROPDMGEXP[(sdata$PROPDMGEXP %in% c("H", "h"))] <-2
sdata$PROPDMGEXP[(sdata$PROPDMGEXP %in% c("", "?", "-", "+"))] <-0
sdata$CROPDMGEXP[(sdata$CROPDMGEXP %in% c("B", "b"))] <-9
sdata$CROPDMGEXP[(sdata$CROPDMGEXP %in% c("M", "m"))] <-6
sdata$CROPDMGEXP[(sdata$CROPDMGEXP %in% c("K", "k"))] <-3
sdata$CROPDMGEXP[(sdata$CROPDMGEXP %in% c("H", "h"))] <-2
sdata$CROPDMGEXP[(sdata$CROPDMGEXP %in% c("", "?", "-", "+"))] <-0
# convert *DMGEXP values to class "integer"" and calculate the normalized damage values
sdata$PROPDMGEXP<-as.integer(sdata$PROPDMGEXP)
sdata$CROPDMGEXP<-as.integer(sdata$CROPDMGEXP)
sdata$PROPDMGVAL <- sdata$PROPDMG * 10^sdata$PROPDMGEXP
sdata$CROPDMGVAL <- sdata$CROPDMG * 10^sdata$CROPDMGEXP
# Chunk 7
require(stringr)
sdata$EVTYPE <- toupper(sdata$EVTYPE)
sdata$EVTYPE <- str_trim(sdata$EVTYPE)
uev2 <- data.frame(unique(sdata$EVTYPE))
uev<-read.csv("NOAA_EVTYPES.csv")
sdata$INVALID_EVTYPE_IND <- 1
sdata$INVALID_EVTYPE_IND[(sdata$EVTYPE %in% uev$EVTYPE)] <- 0
sdata$OB<-1
sum(sdata$INVALID_EVTYPE_IND)
fie<-sum(sdata$FATALITIES[(sdata$INVALID_EVTYPE_IND==1)])
fTotal<-sum(sdata$FATALITIES)
fie/fTotal
iie<-sum(sdata$INJURIES[(sdata$INVALID_EVTYPE_IND==1)])
iTotal<-sum(sdata$INJURIES)
iie/iTotal
pdie<-sum(sdata$PROPDMGVAL[(sdata$INVALID_EVTYPE_IND==1)])
pdTotal<-sum(sdata$PROPDMGVAL)
pdie/pdTotal
cdie<-sum(sdata$CROPDMGVAL[(sdata$INVALID_EVTYPE_IND==1)])
cdTotal<-sum(sdata$CROPDMGVAL)
cdie/cdTotal
# Chunk 8
evtypeMap<-read.csv("EVTYPE_MAP.csv")
tidy_sdata <- merge(evtypeMap,sdata,all.y = TRUE)
sum(is.na(tidy_sdata$NOAA_EVTYPE))
# Chunk 9
# aggregate the data by the "tidy" event type
dead <- aggregate(FATALITIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
dead$IMPACT_TYPE <- "FATALITIES"
colnames(dead)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
dead$NOAA_EVTYPE <- factor(dead$NOAA_EVTYPE,
levels = dead$NOAA_EVTYPE[order(-dead$IMPACT_VAL)])
dead<-dead[order(-xtfrm(dead$IMPACT_VAL),dead$NOAA_EVTYPE),]
rownames(dead)<-seq(1:nrow(dead))
wounded <- aggregate(INJURIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
wounded$NOAA_EVTYPE <- factor(wounded$NOAA_EVTYPE,
levels = wounded$NOAA_EVTYPE[order(-wounded$IMPACT_VAL)])
wounded$IMPACT_TYPE <- "INJURIES"
colnames(wounded)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
wounded<-wounded[order(-xtfrm(wounded$IMPACT_VAL),wounded$NOAA_EVTYPE),]
rownames(wounded)<-seq(1:nrow(wounded))
property <- aggregate(PROPDMGVAL ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
property$NOAA_EVTYPE <- factor(property$NOAA_EVTYPE,
levels = property$NOAA_EVTYPE[order(-property$IMPACT_VAL)])
property$IMPACT_TYPE <- "PROPDMGVAL"
colnames(property)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
property<-property[order(-xtfrm(property$IMPACT_VAL),property$NOAA_EVTYPE),]
rownames(property)<-seq(1:nrow(property))
crops <- aggregate(CROPDMGVAL ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
crops$IMPACT_TYPE <- "CROPDMGVAL"
colnames(crops)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
crops$NOAA_EVTYPE <- factor(crops$NOAA_EVTYPE,
levels = crops$NOAA_EVTYPE[order(-crops$IMPACT_VAL)])
crops<-crops[order(-xtfrm(crops$IMPACT_VAL),crops$NOAA_EVTYPE),]
rownames(crops)<-seq(1:nrow(crops))
# impact <- dead[,c(3,1,2)]
# impact <- rbind(impact, wounded[,c(3,1,2)])
# impact <- rbind(impact, property[,c(3,1,2)])
# impact <- rbind(impact, crops[,c(3,1,2)])
# impact$NOAA_EVTYPE <- factor(crops$NOAA_EVTYPE,
#                            levels = crops$NOAA_EVTYPE[order(-crops$IMPACT_VAL)])
# Chunk 10
require(ggplot2)
# Health Impact Analysis
gg1<- ggplot(dead[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg1<- gg1 + geom_bar(stat = "identity")
gg1<- gg1 + xlab("")
gg1<- gg1 + ylab("Fatalities")
gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
gg2<- gg2 + xlab("")
gg2<- gg2 + ylab("Injuries")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Health Impact of Severe Weather in the United States
by Event Type")
require(ggplot2)
# Health Impact Analysis
gg1<- ggplot(dead[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg1<- gg1 + geom_bar(stat = "identity")
gg1<- gg1 + xlab("")
gg1<- gg1 + ylab("Fatalities")
gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[5:1,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
gg2<- gg2 + xlab("")
gg2<- gg2 + ylab("Injuries")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Health Impact of Severe Weather in the United States
by Event Type")
View(wounded)
evtypeMap<-read.csv("EVTYPE_MAP.csv")
tidy_sdata <- merge(evtypeMap,sdata,all.y = TRUE)
sum(is.na(tidy_sdata$NOAA_EVTYPE))
# aggregate the data by the "tidy" event type
dead <- aggregate(FATALITIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
dead$IMPACT_TYPE <- "FATALITIES"
colnames(dead)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
dead$NOAA_EVTYPE <- factor(dead$NOAA_EVTYPE,
levels = dead$NOAA_EVTYPE[order(-dead$IMPACT_VAL)])
dead<-dead[order(-xtfrm(dead$IMPACT_VAL),dead$NOAA_EVTYPE),]
rownames(dead)<-seq(1:nrow(dead))
wounded <- aggregate(INJURIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
wounded$IMPACT_TYPE <- "INJURIES"
colnames(wounded)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
wounded$NOAA_EVTYPE <- factor(wounded$NOAA_EVTYPE,
levels = wounded$NOAA_EVTYPE[order(-wounded$IMPACT_VAL)])
wounded<-wounded[order(-xtfrm(wounded$IMPACT_VAL),wounded$NOAA_EVTYPE),]
rownames(wounded)<-seq(1:nrow(wounded))
property <- aggregate(PROPDMGVAL ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
property$IMPACT_TYPE <- "PROPDMGVAL"
colnames(property)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
property$NOAA_EVTYPE <- factor(property$NOAA_EVTYPE,
levels = property$NOAA_EVTYPE[order(-property$IMPACT_VAL)])
property<-property[order(-xtfrm(property$IMPACT_VAL),property$NOAA_EVTYPE),]
rownames(property)<-seq(1:nrow(property))
crops <- aggregate(CROPDMGVAL ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
crops$IMPACT_TYPE <- "CROPDMGVAL"
colnames(crops)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
crops$NOAA_EVTYPE <- factor(crops$NOAA_EVTYPE,
levels = crops$NOAA_EVTYPE[order(-crops$IMPACT_VAL)])
crops<-crops[order(-xtfrm(crops$IMPACT_VAL),crops$NOAA_EVTYPE),]
rownames(crops)<-seq(1:nrow(crops))
# impact <- dead[,c(3,1,2)]
# impact <- rbind(impact, wounded[,c(3,1,2)])
# impact <- rbind(impact, property[,c(3,1,2)])
# impact <- rbind(impact, crops[,c(3,1,2)])
# impact$NOAA_EVTYPE <- factor(crops$NOAA_EVTYPE,
#                            levels = crops$NOAA_EVTYPE[order(-crops$IMPACT_VAL)])
require(ggplot2)
# Health Impact Analysis
gg1<- ggplot(dead[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg1<- gg1 + geom_bar(stat = "identity")
gg1<- gg1 + xlab("")
gg1<- gg1 + ylab("Fatalities")
gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
gg2<- gg2 + xlab("")
gg2<- gg2 + ylab("Injuries")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Health Impact of Severe Weather in the United States
by Event Type")
# aggregate the data by the "tidy" event type
dead <- aggregate(FATALITIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
dead$IMPACT_TYPE <- "FATALITIES"
colnames(dead)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
dead$NOAA_EVTYPE <- factor(dead$NOAA_EVTYPE,
levels = dead$NOAA_EVTYPE[order(-dead$IMPACT_VAL)])
dead<-dead[order(-xtfrm(dead$IMPACT_VAL),dead$NOAA_EVTYPE),]
rownames(dead)<-seq(1:nrow(dead))
wounded <- aggregate(INJURIES ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
wounded$IMPACT_TYPE <- "INJURIES"
colnames(wounded)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
wounded$NOAA_EVTYPE <- factor(wounded$NOAA_EVTYPE,
levels = wounded$NOAA_EVTYPE[order(-wounded$IMPACT_VAL)])
wounded<-wounded[order(-xtfrm(wounded$IMPACT_VAL),wounded$NOAA_EVTYPE),]
rownames(wounded)<-seq(1:nrow(wounded))
property <- aggregate(PROPDMGVAL ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
property$IMPACT_TYPE <- "PROPDMGVAL"
colnames(property)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
property$NOAA_EVTYPE <- factor(property$NOAA_EVTYPE,
levels = property$NOAA_EVTYPE[order(-property$IMPACT_VAL)])
property<-property[order(-xtfrm(property$IMPACT_VAL),property$NOAA_EVTYPE),]
rownames(property)<-seq(1:nrow(property))
crops <- aggregate(CROPDMGVAL ~ NOAA_EVTYPE, data = tidy_sdata, FUN = sum)
crops$IMPACT_TYPE <- "CROPDMGVAL"
colnames(crops)<- c("NOAA_EVTYPE","IMPACT_VAL","IMPACT_TYPE")
crops$NOAA_EVTYPE <- factor(crops$NOAA_EVTYPE,
levels = crops$NOAA_EVTYPE[order(-crops$IMPACT_VAL)])
crops<-crops[order(-xtfrm(crops$IMPACT_VAL),crops$NOAA_EVTYPE),]
rownames(crops)<-seq(1:nrow(crops))
# impact <- dead[,c(3,1,2)]
# impact <- rbind(impact, wounded[,c(3,1,2)])
# impact <- rbind(impact, property[,c(3,1,2)])
# impact <- rbind(impact, crops[,c(3,1,2)])
# impact$NOAA_EVTYPE <- factor(crops$NOAA_EVTYPE,
#                            levels = crops$NOAA_EVTYPE[order(-crops$IMPACT_VAL)])
require(ggplot2)
# Health Impact Analysis
gg1<- ggplot(dead[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg1<- gg1 + geom_bar(stat = "identity")
gg1<- gg1 + xlab("")
gg1<- gg1 + ylab("Fatalities")
gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
gg2<- gg2 + xlab("")
gg2<- gg2 + ylab("Injuries")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Health Impact of Severe Weather in the United States
by Event Type")
# Health Impact Analysis
gg1<- ggplot(property[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg1<- gg1 + geom_bar(stat = "identity")
gg1<- gg1 + xlab("")
gg1<- gg1 + ylab("Property Damage (USD)")
gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
gg2<- gg2 + xlab("")
gg2<- gg2 + ylab("Crop Damage (USD)")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Economic Impact of Severe Weather in the United States
by Event Type")
require(ggplot2)
# Health Impact Analysis
gg1<- ggplot(dead[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg1<- gg1 + geom_bar(stat = "identity")
gg1<- gg1 + xlab("")
gg1<- gg1 + ylab("Fatalities")
gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
gg2<- gg2 + xlab("")
gg2<- gg2 + ylab("Injuries")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Health Impact of Severe Weather in the United States
by Event Type")
# Economic Impact Analysis
gg1<- ggplot(property[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg1<- gg1 + geom_bar(stat = "identity")
gg1<- gg1 + xlab("")
gg1<- gg1 + ylab("Property Damage")
gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
gg2<- gg2 + xlab("")
gg2<- gg2 + ylab("Crop Damage")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Economic Impact (USD) of Severe Weather in the United States by Event Type")
require(ggplot2)
# Health Impact Analysis
gg1<- ggplot(dead[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg1<- gg1 + geom_bar(stat = "identity")
gg1<- gg1 + xlab("")
gg1<- gg1 + ylab("Fatalities")
gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
gg2<- gg2 + xlab("")
gg2<- gg2 + ylab("Injuries")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Health Impact of Severe Weather in the United States
by Event Type")
# Economic Impact Analysis
gg1<- ggplot(property[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg1<- gg1 + geom_bar(stat = "identity")
gg1<- gg1 + xlab("")
gg1<- gg1 + ylab("Property Damage")
gg1<- gg1 + theme(axis.text.x = element_text(angle=90))
gg2<- ggplot(wounded[1:5,], aes(x = NOAA_EVTYPE, y = IMPACT_VAL))
gg2<- gg2 + geom_bar(stat = "identity")
gg2<- gg2 + xlab("")
gg2<- gg2 + ylab("Crop Damage")
gg2<- gg2 + theme(axis.text.x = element_text(angle=90))
require(grid)
require(gridExtra)
grid.arrange(gg1, gg2, ncol = 2, top = "Economic Impact (US-$) of Severe Weather in the United States by Event Type")
source('~/DataScience/ExploratoryDataAnalysis/exdata-data-NEI_data/clEnv.R', echo=TRUE)
